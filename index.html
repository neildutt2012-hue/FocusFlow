<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Gravity Shift Runner</title>
<style>
  body { margin:0; overflow:hidden; background:#000; font-family:monospace; }
  #scoreBox { position:absolute; top:10px; left:10px; color:#0ff; font-size:22px; }
  canvas { display:block; }
</style>
</head>
<body>
<div id="scoreBox">Score: <span id="score">0</span></div>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let W = canvas.width = window.innerWidth;
let H = canvas.height = window.innerHeight;

window.onresize = () => {
  W = canvas.width = window.innerWidth;
  H = canvas.height = window.innerHeight;
};

// Player
let player = {
  x: 120,
  y: H - 150,
  w: 50,
  h: 50,
  gravityDirection: 1, // 1 = down, -1 = up
};

// Obstacles
let obstacles = [];
let speed = 9;
let score = 0;
let gameOver = false;

// Spawn obstacles on ceiling or floor
function spawnObstacle() {
  const height = 60;
  const lane = Math.random() < 0.5 ? "floor" : "ceiling";

  obstacles.push({
    x: W + 50,
    y: lane === "floor" ? H - 100 - height : 100,
    w: 50 + Math.random() * 30,
    h: height,
    lane
  });
}

setInterval(spawnObstacle, 1200);

// Reset
function reset() {
  obstacles = [];
  speed = 9;
  score = 0;
  player.y = H - 150;
  player.gravityDirection = 1;
  gameOver = false;
}

// Update logic
function update() {
  if (gameOver) return;

  // Move player to correct lane
  if (player.gravityDirection === 1) {
    // Fall down
    player.y += 20;
    if (player.y + player.h > H - 100) {
      player.y = H - 100 - player.h;
    }
  } else {
    // Fall up
    player.y -= 20;
    if (player.y < 100) {
      player.y = 100;
    }
  }

  // Move obstacles
  for (let o of obstacles) {
    o.x -= speed;
  }

  // Remove off-screen
  obstacles = obstacles.filter(o => o.x + o.w > 0);

  // Collision
  for (let o of obstacles) {
    if (player.x < o.x + o.w &&
        player.x + player.w > o.x &&
        player.y < o.y + o.h &&
        player.y + player.h > o.y) {
      alert("GAME OVER! Score: " + Math.floor(score));
      reset();
      return;
    }
  }

  speed += 0.003;
  score += 0.1;
  document.getElementById("score").textContent = Math.floor(score);
}

// Draw
function draw() {
  ctx.clearRect(0, 0, W, H);

  // Top + Bottom run bars
  ctx.fillStyle = "#044";
  ctx.fillRect(0, 100, W, 5);
  ctx.fillRect(0, H - 100, W, 5);

  // Player
  ctx.fillStyle = "#0ff";
  ctx.fillRect(player.x, player.y, player.w, player.h);

  // Obstacles
  ctx.fillStyle = "#f0f";
  for (let o of obstacles) {
    ctx.fillRect(o.x, o.y, o.w, o.h);
  }
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();

// Controls
window.addEventListener("keydown", e => {
  if (e.code === "Space") {
    player.gravityDirection *= -1; // Flip gravity
  }
});
</script>
</body>
</html>
